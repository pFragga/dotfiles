#!/bin/sh

md_dir="${1:-"$HOME/Documents/Markdown"}"
[ -d "$md_dir" ] || exit 1

choose_md() {
	find "$md_dir" -type f -name '*.md' | fzf
}

printf '1) %s\n2) ranger\n3) %s\nSelect an application: ' "$EDITOR" "$PAGER"
read -r REPLY
case $REPLY in
	1|$EDITOR)
		"$EDITOR" "$(choose_md)"
		;;
	2|ranger)
		ranger "$md_dir"
		;;
	3|$PAGER)
		if which lowdown >/dev/null 2>&1; then
			# FIXME this screws up the terminal after quitting PAGER
			lowdown -tterm "$(choose_md)" | "$PAGER" -R
			clear
		else
			"$PAGER" "$(choose_md)"
		fi
		;;
esac
